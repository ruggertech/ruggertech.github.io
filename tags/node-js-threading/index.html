<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	

	<title>Nodeland</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
	
	
	<link rel="stylesheet" href="/css/normalize.css" type="text/css">
	<link rel="stylesheet" href="/css/basscss.css" type="text/css">
	<link rel="stylesheet" href="/css/basscss-ui-groups.css" type="text/css">
	<link rel="stylesheet" href="/css/tomorrow.css" type="text/css">
	<link rel="stylesheet" href="/css/style.css" type="text/css">
	
		<link href="https://jerry.im/gapi/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
	

	<!--[if lt IE 9]><script src="/js/html5.js" type="text/javascript"></script><![endif]-->
	<script src="/js/main.js" type="text/javascript"></script>
</head>

<body>
	<section class="container m4 clearfix">
		<div class="clearfix">
			<div class="mb4 sm-flex center nowrap">
	<div class="flex-auto block">
		<p class="inline h2">Nodeland</p> | <small class="muted">The land of node.js</small>
	</div>
</div>

			<div class="mn1 center">
	
		<a href="/./" class="btn button-narrow">Home</a>
	
		<a href="/archives/" class="btn button-narrow">Archives</a>
	
		<a href="/tags/" class="btn button-narrow">Tags</a>
	
	<a href="/search.html" class="btn button-narrow" onclick="loadJQuery(this, event);" data-modal>
		<svg class="icon" data-icon="search"></svg>
	</a>
</div>

			<div class="p0 col col-12">
				<div class="mt2 p0">
	<span class="btn button-narrow">Tags</span>
	<svg class="icon gray" data-icon="chevron-right"></svg>
	<span class="btn button-narrow">node.js threading</span>
</div>

	<div class="m0 py2">
	<div class="md-col-12">
		<div class="overflow-hidden bg-white rounded">
			<div class="m1 p2 white">
				<div class="clearfix">
					<div class="left">
						<h1 class="h2 m0"><a href="/2016/04/24/so-you-thought-node-js-was-single-threaded/" class="black">
						So you thought node.js was single threaded
						</a></h1>
					</div>
					<div class="right"><span class="h6 muted black">
						Apr 24 2016
					</span></div>
				</div>
			</div>
			<div class="p2 border-top">
				<p>Did you think that node.js is single threaded? well, not quite:</p>
<p>Node.js is a framework that uses google’s chrome v8 javascript engine to <strong>compile</strong> javascript into native code (compile, not interpret).</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js code —&gt; v8 —&gt; native code</span><br></pre></td></tr></table></figure>
<p>It is officially documented as single threaded, but only the javascript environment runs as a single thread, all the other threads (yes, there are) are handled by other C libraries.</p>
<h3 id="The-v8-event-loop"><a href="#The-v8-event-loop" class="headerlink" title="The v8 event loop"></a>The v8 event loop</h3><p>Node.js is event-driven, and has only one permanent event loop - that’s the v8 event loop.<br>The v8 loop is the one that handles all the javascript parts, some are async calls/tasks.</p>
<h3 id="Delegate-the-async-tasks-to-a-threadpool"><a href="#Delegate-the-async-tasks-to-a-threadpool" class="headerlink" title="Delegate the async tasks to a threadpool"></a>Delegate the async tasks to a threadpool</h3><p>To handle async -tasks- it uses a threadpool (calling the Libev and LibEio libraries, both written in C)<br>Libev provides LibEio communication with the v8 loop (what we know as the node event loop)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node v8 loop &lt;--&gt; (Libev) &lt;--&gt; Async Tasks threads, fs and comm(LibUv(LibEio))</span><br></pre></td></tr></table></figure>
<p>LibEio is a library that performs IO asynchronously.<br>LibUv is an abstraction layer on top of LibEio, Libev. It manages all the IO and events in the event pool.</p>

			</div>
			<div class="p2 border-top">
				<div class="clearfix">
					<div class="left">
						
							<script type="text/javascript">
								document.write('<a href="/tags/node-js-threading/" class="muted h6 mb1 bold btn btn-outline '+chooseOne(colors)+'">node.js threading</a>');
								//document.write('<span onclick="window.location=\'' + ' /tags/node-js-threading/ ' + '\'" class="clickable h6 bold inline-block px1 '+chooseOne(colors)+' rounded">node.js threading</span>');
							</script>
						
					</div>
					<div class="ml2 right"><span class="h6 muted black"> </span></div>
				</div>
			</div>
		</div>
	</div>
	
</div>


<div class="clearfix">
	
	
	<div class="overflow-hidden sm-show center">
		
			<a href="/tags/node-js-threading/" class="btn btn-primary bg-gray">1</a>
		
		
		
			
		
			
		
		
		
			
		
			
		

		

		
	</div>
</div>


			</div>
		</div>
	</section>
	<div class="container mb2 clearfix">
	<div class="sm-flex center nowrap mb2 h5">
		<div class="flex-auto border-bottom">
			<a href="https://hexo.io/" class="btn block muted">Hexo</a>
		</div>
		<div class="flex-auto border-bottom">
			<a href="https://jerry.im/essays/2016/02/hexo-theme-weightless/" class="btn block">Weightless</a> Theme
		</div>
		<div class="flex-auto border-bottom">
			Rocking <a href="http://www.basscss.com/" class="btn block">Basscss</a>
		</div>
		<div class="flex-auto border-bottom">
			
		</div>
	</div>
</div>
<script src="/js/geomicons.js"></script>
<script type="text/javascript">
	var icons = document.querySelectorAll('[data-icon]');
	geomicons.inject(icons);
</script>


	<!-- Piwik -->
	<script type="text/javascript">
	  var _paq = _paq || [];
	  _paq.push(['trackPageView']);
	  _paq.push(['enableLinkTracking']);
	  (function() {
	    var u="//communistanalytics.com/";
	    _paq.push(['setTrackerUrl', u+'piwik.php']);
	    _paq.push(['setSiteId', 1]);
	    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
	  })();
	</script>
	<noscript><p><img src="//communistanalytics.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
	<!-- End Piwik Code -->



</body>
</html>
